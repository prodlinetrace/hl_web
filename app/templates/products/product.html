{% extends "base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block page_content %}
<div class="page-header">
    {% include "products/_product_header.html" %}
</div>

<div class="product-body">
	<h3 id="comments">Product Overview</h3>
	    {% if product.type %}
		    <div class="product-main">
		    Type: {{ product.type | safe }}
		    </div>
	    {% endif %}
	    {% if product.serial %}
		    <div class="product-main">
		    	Serial: {{ product.serial | safe }}
		    </div>
	    {% endif %}
	    {% if product.year %}
		    <div class="product-main">
		    	Year: {{ product.year | safe }}
	    	</div>
	    {% endif %}
	    {% if product.week %}
		    <div class="product-main">
		    	Week: {{ product.week | safe }}
	    	</div>
	    {% endif %}
	    {% if product.date_added %}
		    <div class="product-main">
		    	Date Added: {{ product.date_added | safe }}
	    	</div>
	    {% endif %}
	<h3 id="comments">Status Overview</h3>
	<table cellspacing="1" id="statuses" class="statuses tablesorter"> 
		<thead>
	   		<tr>
	            <th>Station Id</th>
	            <th>Station Name</th>
	            <th>Date</th>
	            <th>Overall Status</th>
	        </tr>
        </thead>
        <tbody>
			{% for status in product.statuses %}
   			<tr>
				<td>{{ status.station.id }} </td>
    			<td>{{ status.station.name }} </td>
    			<td>{{ status.date_time }} </td>
    			<td>{{ status.status }} </td>
   			</tr>
			{% endfor %}
        </tbody>
    </table>
	
	<h3 id="comments">Operation Overview</h3>
	<table cellspacing="1" id="operations" class="tablesorter"> 
		<thead>
	   		<tr>
	            <th>Station Id</th>
	            <th>Station Name</th>
	            <th>Overall Status</th>
	            <th>Operation Name</th>
	            <th>Date</th>
	            <th>Operation Measurement:<br/>Result | Min | Max | Status</th>
	        </tr>
        </thead>
        <tbody>
			{% for operation in product.operations|sort %}
    		<tr>
    			<td>{{ operation.station_id }}</td>
    			<td>{{ operation.station.name }}</td>
    			<td>{{ operation.operation_status }}</td>
    			<td>{{ operation.operation_type.name }}</td>
    			<td>{{ operation.date_time }} </td>
    			<td> 
    				<table id="result" class="operation_data">
			        	<tbody>
			    			{% if operation.result_1 %}
			    				<tr><td>{{ operation.result_1}}</td><td>{{ operation.result_1_max}}</td><td>{{ operation.result_1_min}}</td><td>{{ operation.result_1_status}}</td></tr>
			    			{% endif %}
			    			{% if operation.result_2 %}
			    				<tr><td>{{ operation.result_2}}</td><td>{{ operation.result_2_max}}</td><td>{{ operation.result_2_min}}</td><td>{{ operation.result_2_status}}</td></tr>
			    			{% endif %}
			    			{% if operation.result_3 %}
			    				<tr><td>{{ operation.result_3}}</td><td>{{ operation.result_3_max}}</td><td>{{ operation.result_3_min}}</td><td>{{ operation.result_3_status}}</td></tr>
			    			{% endif %}
	    		        </tbody>
    				</table>
    			</td>
    		</tr>
			{% endfor %}
		</tbody>
	</table>
	

 	{% if product.statuses %}
 		<div>
 		</div> 
 	{% endif %}
	    
</div>
	{% if comments %}
		<h3 id="comments">Comments</h3>
		{% include "products/_comments.html" %}
		<ul class="pager">
		    {% if pagination.has_prev %}
			    <li class="previous"><a href="{{ url_for('products.product', id=product.id, page=pagination.prev_num) }}#comments">&larr; Older</a></li>
			    {% else %}
			    <li class="previous disabled"><a href="#">&larr; Older</a></li>
			    {% endif %}
		    {% if pagination.has_next %}
			    <li class="next"><a href="{{ url_for('products.product', id=product.id, page=pagination.next_num) }}#comments">Newer &rarr;</a></li>
			    {% else %}
			    <li class="next disabled"><a href="#">Newer &rarr;</a></li>
		    {% endif %}
		</ul>
	{% endif %}
	{% if form %}
		<h3 id="comment-form">Write a comment</h3>
		{{ wtf.quick_form(form, action='#comment-form') }}
	{% endif %}
{% endblock %}

{% block scripts %}
	{{ super() }}
	{{ pagedown.include_pagedown() }}
	<script src="/static/jquery.autosize.min.js"></script>
	<script>
	    $(document).ready(function() {
	        $('#flask-pagedown-body').autosize();
	    });
	</script>
	<script type="text/javascript" src="/static/jquery.tablesorter.min.js"></script> 
	
	<script type="text/javascript">
	$(document).ready(function() 
		    { 
				$("#statuses").tablesorter(); 
		        $("#operations").tablesorter(); 
		    } 
		); 
	</script>	
	{% include "_api_client.html" %}
{% endblock %}
